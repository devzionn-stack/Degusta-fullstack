# Início do arquivo docker-compose.yml

services:
  # SERVIÇO 1: Sua aplicação
  app:
    build:
      context: .
      dockerfile: Dockerfile
    restart: always
    ports:
      - "5000:5000"
    environment:
      # --- VARIÁVEIS DEFINIDAS DIRETAMENTE AQUI ---
      
      # 1. URL do Banco de Dados (aponta para o serviço 'db' abaixo)
      DATABASE_URL: "postgresql://pizzaiolo:SuaSenhaSuperForte123@db:5432/degusta_db"
      
      # 2. Chave Secreta da Sessão (cole seu valor aqui)
      SESSION_SECRET: "zG3B3D~87]Dw"
      
      # 3. Chave da OpenAI (cole sua chave aqui)
      OPENAI_API_KEY: "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"

    depends_on:
      - db

  # SERVIÇO 2: O banco de dados PostgreSQL
  db:
    image: postgres:15
    restart: always
    environment:
      # Estas variáveis criam o banco e o usuário. Use a MESMA senha da DATABASE_URL.
      POSTGRES_DB: degusta_db
      POSTGRES_USER: pizzaiolo
      POSTGRES_PASSWORD: SuaSenhaSuperForte123
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:

# Fim do arquivo docker-compose.yml
